{% extends 'base.html'%}
{% load static %}

{% block title %} | Dashboard {% endblock %}

{% block content %}

{% url 'home' as home_url %}
{% url 'account:login' as login_url %}
{% url 'travel:home' as home_url %}
{% url 'logout' as logout_url %}
{% url 'travel:add_trip' as add_trip_url %}


<!-- Navbar Section -->
    <div class="wrapper">
      <div class="header">
        <!-- NAV Bar -->
        <div class="navbar">
          <a class="navbar-brand" href="{{ home_url }}">
            <img src="{% static 'img/airplane_logo.png'%}" alt="airplane logo">
          </a>
          <h3>Hello, {{ user.first_name }}</h3>
          <a href="{{ add_trip_url }}" class="btn btn-info">Add Trip</a> <a href="{{ logout_url }}" class="btn btn-danger">Logout</a>
        </div>
      </div>
      <!-- Main Content -->
      <div class="container">

        <div class="user_trips" id="">
        {% if user_trips %}
          <h4 class="text-center">Your Scheduled Trips</h4>
          <div class="table_container">
            <table class="table table-dark text-center" >
              <thead>
                <tr >
                  <th scope="col .d-none .d-sm-block">#</th>
                  <th scope="col">Destination</th>
                  <th scope="col">Travel Start Date</th>
                  <th scope="col">Travel End Date</th>
                  <th scope="col">Plan</th>
                </tr>
              </thead>
              <tbody>
              {% for location in user_trips %}
                <tr>
                  <th scope="row">
                      <form method="POST" action='{% url "travel:destination_update" %}' data-endpoint='{% url "travel:destination_update" %}'>
                          {% csrf_token %}
                          <input type="hidden" name="destination_id" value="{{ location.id }}" />
                        <button class="btn btn-warning btn-sm" type="submit">Remove</button>
                      </form>
                    {% if location.planner.id == user.id %}<form method="POST" action='{% url "travel:destination_update" %}' data-endpoint='{% url "travel:destination_update" %}'>
                          {% csrf_token %}
                          <input type="hidden" name="destination_id" value="{{ location.id }}" />
                          <input type="hidden" name="planner" value="{{ True }}" />
                        <button class="btn btn-danger btn-sm" type="submit">Delete</button>
                      </form>
                    {% endif %}
                  </th>
                  <td><a href="{{ location.get_absolute_url }}">{{ location.location }}</a></td>
                  <td>{{ location.start_date }}</td>
                  <td>{{ location.end_date }}</td>
                  <td>{{ location.description }}</td>
                </tr>
              {% endfor %}
              </tbody>
            </table>
          </div>
          {% else %}
            <div class="row">
                <h3>
                    No Trips scheduled. <a  class="btn btn-warning btn-sm" href=""> Add Plan</a>
                  </h3>
             
            </div>
          </div>
          {% endif %}


        {% if other_users_trips %}
          <div class="others_trips">
            <h4 class="text-center pad">Other User's Travel Plans</h4>
            <div class="table_container">
              <table class="table table-dark text-center">
                <thead>
                  <tr>
                    <th scope="col" class="d-none d-md-block">Name</th>
                    <th scope="col">Destination</th>
                    <th scope="col">Travel Start Date</th>
                    <th scope="col">Travel End Date</th>
                    <th scope="col">Do you want to Join?</th>
                  </tr>
                </thead>
                <tbody>
                {% for trip in other_users_trips %}
                  <tr>
                    <td class="d-none d-md-block">{{ trip.planner.first_name }}</td>
                    <td><a href="/travels/destination/{{ trip.id }}">{{ trip.location }}</a></td>
                    <td>{{ trip.start_date }}</td>
                    <td>{{ trip.end_date }}</td>
                    <form method="POST" action='{% url "travel:destination_update" %}' data-endpoint='{% url "travel:destination_update" %}'>
                        {% csrf_token %}
                        <input type="hidden" name="destination_id" value="{{ trip.id }}" />
                      <td><button class="btn btn-info" type="submit">Join</button></td>
                    </form>
                  </tr>
                {% endfor %}
                </tbody>
              </table>
            </div>
          </div>
          {% else %}
          <div class="row">
              <h3>
                  There no trips scheduled by other users.
              </h3>
          </div>
          </div>
        {% endif %}
      </div>
    </div>

{% endblock %}
